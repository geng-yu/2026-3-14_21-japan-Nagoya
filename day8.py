import streamlit as st
import pandas as pd
from utils import get_gmap_link

def show():

    # ==========================================
    # 0. 航班資訊
    # ==========================================
    with st.container(border=True):
        st.subheader("🛫 國泰航空 CX531")
        st.markdown("""
        * 16:40 NGO 起飛 → 19:15 TPE 抵達
        """)

    st.divider()

    # ==========================================
    # 1. 早餐：麥當勞
    # ==========================================
    st.subheader("1️⃣ 最後的早餐：麥當勞")

    st.markdown("**Step 1：步行導航**")
    st.caption("地點：麥當勞 榮大津通店")
    st.link_button("🍔 導航：McDonald's Sakae Otsudori", get_gmap_link("McDonald's Sakae Otsu-dori", "walking"))
    st.info("💡 **麥當勞**：鬆餅漢堡、期間限定派")

    st.divider()

    # ==========================================
    # 2. 前往機場：方案 A (巴士)
    # ==========================================
    st.subheader("2️⃣ 交通方案 A：利木津巴士 (優先)")

    st.markdown("**Step 1：前往搭車點**")
    st.markdown("""
    * **地點**：綠洲21 (Oasis 21) 巴士總站
    * **月台**：**9號乘車處**
    * **發車時間**：**12:10** (預計 12:55 抵達機場)
    """)
    st.link_button("🚌 導航：Oasis 21 巴士總站", get_gmap_link("Oasis 21 Bus Terminal", "walking"))

    st.warning("⚠️ **風險**：巴士客滿，請立刻啟用下方的「方案 B」")

    st.divider()

    # ==========================================
    # 3. 前往機場：方案 B (地鐵+名鐵)
    # ==========================================
    st.subheader("3️⃣ 交通方案 B：電車 (備案)")

    st.markdown("**Step 1：搭地鐵 (名城線 紫色)**")
    st.markdown("`榮站 (Sakae)` ➔ `金山站 (Kanayama)`")
    st.link_button("🚇 導航：榮站 (入口)", get_gmap_link("Sakae Station Nagoya", "walking"))

    st.markdown("**Step 2：轉乘名鐵 (Meitetsu)**")
    st.markdown("""
    1.  金山站下車，出站後跟著「名鐵線 (Meitetsu Line)」指標走
    2.  進入名鐵閘門，前往中部國際機場方向月台
    3.  **票價說明**：
        * **一般特急 (部分指定)**：車資 ¥980 (自由座) + ¥450 (指定車廂)
        * **μ-SKY (全車指定)**：車資 ¥980 + μ-Ticket ¥450 (必買)
    """)
    st.link_button("🚄 導航：名鐵金山站", get_gmap_link("Kanayama Station Meitetsu", "walking"))

    st.markdown("### 🚄 金山站 -> 機場 時刻表")
    
    # 建立時刻表資料
    train_data = [
        {"出發": "12:05", "到達": "12:36", "耗時": "31分", "車種": "🔴 特急 (部分指定)"},
        {"出發": "12:11", "到達": "13:26", "耗時": "75分", "車種": "🐢 普通 (不推薦)"},
        {"出發": "12:19", "到達": "13:03", "耗時": "44分", "車種": "🟢 準急"},
        {"出發": "12:24", "到達": "12:48", "耗時": "24分", "車種": "🔵 μ-SKY (全車指定)"},
        {"出發": "12:35", "到達": "13:06", "耗時": "31分", "車種": "🔴 特急 (部分指定)"},
        {"出發": "12:41", "到達": "13:56", "耗時": "75分", "車種": "🐢 普通 (不推薦)"},
        {"出發": "12:49", "到達": "13:33", "耗時": "44分", "車種": "🟢 準急"},
        {"出發": "12:54", "到達": "13:18", "耗時": "24分", "車種": "🔵 μ-SKY (全車指定)"},
        {"出發": "13:05", "到達": "13:36", "耗時": "31分", "車種": "🔴 特急 (部分指定)"},
        {"出發": "13:19", "到達": "14:03", "耗時": "44分", "車種": "🟢 準急"},
        {"出發": "13:24", "到達": "13:48", "耗時": "24分", "車種": "🔵 μ-SKY (全車指定)"},
    ]
    
    df = pd.DataFrame(train_data)
    st.dataframe(df, hide_index=True, use_container_width=True)
    st.caption("🔵 μ-SKY 最快但全車指定席 / 🔴 特急推薦搭自由座車廂即可 / 🐢 普通車千萬不要搭")

    st.divider()

    # ==========================================
    # 4. 機場購物攻略
    # ==========================================
    st.subheader("4️⃣ 中部國際機場 (Centrair) 購物")
    
    st.markdown("**Step 1：報到前 (Landside - 4F Sky Town)**")
    st.markdown("這裡最好買！請在掛行李前先買好塞進去。")
    
    with st.expander("🦐 必買：蝦餅之里 (Ebisenbei no Sato)"):
        st.markdown("""
        * **位置**：4F 提燈橫丁 (很顯眼，人最多的那間)
        * **推薦**：綜合包 (最划算)、梅子口味、芥末口味
        * **注意**：**這裡買的可以退稅，建議直接買一箱裝箱託運**
        """)

    with st.expander("🍘 其他 4F 推薦"):
        st.markdown("""
        * **赤福 (Akafuku)**：伊勢名產，紅豆麻糬 (保存期限短)
        * **兩口屋是清**：傳統和菓子，適合送長輩
        * **天むす (炸蝦飯糰)**：4F 有名店「千壽」，可以買幾個上飛機吃或當午餐
        """)

    st.markdown("---")

    st.markdown("**Step 2：出境後 (Airside - 免稅店)**")
    st.markdown("過安檢、護照查驗後，登機前的最後採購")
    
    with st.expander("🍫 免稅店必買"):
        st.markdown("""
        * **Royce 巧克力洋芋片**
        * **東京香蕉 (Tokyo Banana)**：東京名產
        * **白色戀人**：北海道名產
        * **酒類**：獺祭、久保田等日本酒
        * **LeTAO 起司蛋糕**：需購買保冷袋
        """)


if __name__ == "__main__":
    show()
