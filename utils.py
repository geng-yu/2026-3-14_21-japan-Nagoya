# æª”æ¡ˆåç¨±ï¼šutils.py
import streamlit as st

def get_gmap_link(query, mode="transit"):
    # mode: driving (é–‹è»Š), walking (èµ°è·¯), transit (å¤§çœ¾é‹è¼¸)
    base_url = "https://www.google.com/maps/dir/?api=1"
    return f"{base_url}&destination={query}&travelmode={mode}"
import streamlit as st
import pandas as pd

def show_food_table(region):
    """
    é¡¯ç¤ºç¾é£Ÿåº—å®¶çš„è¡¨æ ¼ï¼ŒåŒ…å«å°èˆªé€£çµã€‚
    Args:
        region (str): åœ°å€åç¨±ï¼Œä¾‹å¦‚ "é‡‘æ¾¤", "é£›é©’é«˜å±±", "æ¦®å•†åœˆ"
    """
    
    # ==========================================
    # 1. åœ¨é€™è£¡ç·¨è¼¯æ‚¨çš„åº—å®¶è³‡æ–™
    # ==========================================
    data_source = {
        "é‡‘æ¾¤": [
            {"åº—å": "çƒé›åºµ é‡‘æ¾¤æ±å±±åº—", "æ™‚é–“": "09:30-17:30", "å‚™è¨»": "èœ‚èœœè›‹ç³•(ä¼´æ‰‹ç¦®)"},
            {"åº—å": "ç®”ä¸€ æ±å±±åº—", "æ™‚é–“": "09:00-18:00", "å‚™è¨»": "é‡‘ç®”å†°æ·‡æ·‹"},
            {"åº—å": "Shogun Burger Kanazawa", "æ™‚é–“": "11:00-21:30", "å‚™è¨»": "å’Œç‰›æ¼¢å ¡(CROSS GATE)"},
            {"åº—å": "é‡‘æ¾¤ FOCUS", "æ™‚é–“": "10:00-20:00", "å‚™è¨»": "UNIQLO é€›è¡—"},
            {"åº—å": "é—œæ±ç…® é»‘ç™¾åˆ", "æ™‚é–“": "11:00-22:00", "å‚™è¨»": "é‡‘æ¾¤ç«™å¿…åƒ"},
        ],
        "é£›é©’é«˜å±±": [
            {"åº—å": "å‘³è—å¤©åœ‹", "æ™‚é–“": "17:00-21:00", "å‚™è¨»": "16:30ç™¼è™Ÿç¢¼, é€±äºŒä¸‰å…¬ä¼‘"},
            {"åº—å": "ä¸¸æ˜ é£›é©’é«˜å±±åº—", "æ™‚é–“": "11:00-21:00", "å‚™è¨»": "16:30ç™¼è™Ÿç¢¼, é£›é©’ç‰›ç‡’è‚‰"},
            {"åº—å": "å‰ç”°è£½éºµæ‰€", "æ™‚é–“": "11:00-14:00", "å‚™è¨»": "é€±ä¸€å…¬ä¼‘, çƒé¾éºµ"},
            {"åº—å": "Train Bleu", "æ™‚é–“": "10:00-16:30", "å‚™è¨»": "éºµåŒ…åº—(é€±ä¸‰å…¬ä¼‘), å¯é Œå¿…è²·"},
        ],
        "æ¦®å•†åœˆ": [
            {"åº—å": "ä¸€è˜­ åå¤å±‹æ¦®åº—", "æ™‚é–“": "24hr", "å‚™è¨»": "å°±åœ¨æ¦®ç«™é™„è¿‘"},
            {"åº—å": "ç†±ç”°è“¬èŠè»’ (æ¾å‚å±‹åº—)", "æ™‚é–“": "11:00-20:30", "å‚™è¨»": "16:30è¦æŠ½è™Ÿç¢¼ç‰Œ (å—é¤¨10F)"},
            {"åº—å": "é¦¬å–°ä¸€ä»£ åå¤å±‹æ¦®", "æ™‚é–“": "11:30-23:00", "å‚™è¨»": "é£›é©’ç‰›, å·²é ç´„"},
            {"åº—å": "ä¸–ç•Œçš„å±±å°‡ æœ¬åº—", "æ™‚é–“": "16:00-23:15", "å‚™è¨»": "å¤¢å¹»æ‰‹ç¾½å…ˆ, é›ç¿…å¿…åƒ"},
            {"åº—å": "HARBS åå¤å±‹æ¦®åº—", "æ™‚é–“": "11:00-20:00", "å‚™è¨»": "æ°´æœåƒå±¤è›‹ç³•"},
        ]
    }

    # ==========================================
    # 2. è™•ç†è³‡æ–™èˆ‡é¡¯ç¤º (ä¸ç”¨æ”¹é€™è£¡)
    # ==========================================
    
    # æª¢æŸ¥åœ°å€æ˜¯å¦å­˜åœ¨
    if region not in data_source:
        st.warning(f"âš ï¸ æ‰¾ä¸åˆ° '{region}' çš„è³‡æ–™ï¼Œè«‹æª¢æŸ¥åç¨±æ˜¯å¦æ­£ç¢ºã€‚")
        return

    # å»ºç«‹ DataFrame
    df = pd.DataFrame(data_source[region])

    # è‡ªå‹•ç”¢ç”Ÿ Google Maps å°èˆªé€£çµ
    def get_gmap_link(name):
        return f"https://www.google.com/maps/search/?api=1&query={name}"
    
    # æ–°å¢å°èˆªæ¬„ä½
    df["å°èˆª"] = df["åº—å"].apply(get_gmap_link)
    
    # é‡æ–°æ’åˆ—æ¬„ä½é †åº
    df = df[["åº—å", "å°èˆª", "æ™‚é–“", "å‚™è¨»"]]

    # é¡¯ç¤ºæ‘ºç–Šè¡¨æ ¼
    with st.expander(f"ğŸ½ï¸ é»æˆ‘çœ‹ï¼š{region} ç¾é£Ÿåº—å®¶æ¸…å–®", expanded=False):
        st.data_editor(
            df,
            column_config={
                "åº—å": st.column_config.TextColumn("åº—å", width="medium"),
                "å°èˆª": st.column_config.LinkColumn(
                    "å°èˆª",
                    display_text="ğŸ“ å°èˆª",  # æŒ‰éˆ•ä¸Šé¡¯ç¤ºçš„æ–‡å­—
                    help="é»æ“Šå‰å¾€ Google Maps",
                    validate="^https://.*",
                    width="small"
                ),
                "æ™‚é–“": st.column_config.TextColumn("æ™‚é–“", width="small"),
                "å‚™è¨»": st.column_config.TextColumn("å‚™è¨»", width="large"),
            },
            hide_index=True,   # éš±è—ç´¢å¼• 0, 1, 2...
            disabled=True,     # ç¦æ­¢ç·¨è¼¯ï¼Œè®Šæˆå”¯è®€
            use_container_width=True
        )

# ==========================================
# ä½¿ç”¨ç¯„ä¾‹ (è²¼åœ¨å°æ‡‰çš„å¤©æ•¸ä¸‹æ–¹)
# ==========================================
# show_food_table("é‡‘æ¾¤")
